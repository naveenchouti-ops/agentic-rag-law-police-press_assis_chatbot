from pdf2image import convert_from_path
import pytesseract
from pathlib import Path

PDF_PATH = Path("data/police/delhi_police_scenarios_bns_bnss_bsa.pdf")
OUTPUT_TXT = Path("text/police_scenarios.txt")

POPPLER_PATH = r"C:\poppler-25.12.0\Library\bin"

print("Converting PDF pages to images...")

pages = convert_from_path(
    str(PDF_PATH),
    dpi=300,
    poppler_path=POPPLER_PATH
)

print(f"Total pages: {len(pages)}")

all_text = []

for i, page in enumerate(pages, start=1):
    print(f"OCR page {i}...")
    text = pytesseract.image_to_string(page, lang="eng")
    all_text.append(text)

OUTPUT_TXT.parent.mkdir(exist_ok=True)
OUTPUT_TXT.write_text("\n".join(all_text), encoding="utf-8")

print("âœ… OCR completed successfully!")
